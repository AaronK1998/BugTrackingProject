@page "/storyboardpage"
@using Syncfusion.Blazor.Inputs
@using Syncfusion.Blazor.Kanban
@using Syncfusion.Blazor.Data
@using Models
@using Data
@inject ApplicationDbContext _context


<AuthorizeView Roles="Admin, User">
    <NotAuthorized>
        <p>Sorry, you're not authorized to reach this page.</p>
        <p>You may need to log in as a different user.</p>
    </NotAuthorized>
    <Authorized>

        <SfKanban TValue="TasksModel" KeyField="Status" DataSource="Tasks">
            <KanbanColumns>
                <KanbanColumn HeaderText="To Do" KeyField="@(new List<string>() {"Open"})"></KanbanColumn>
                <KanbanColumn HeaderText="In Progress" KeyField="@(new List<string>() {"InProgress"})"></KanbanColumn>
                <KanbanColumn HeaderText="Testing" KeyField="@(new List<string>() {"Testing"})"></KanbanColumn>
                <KanbanColumn HeaderText="Done" KeyField="@(new List<string>() {"Close"})"></KanbanColumn>
            </KanbanColumns>
            <KanbanCardSettings HeaderField="Title" ContentField="Summary"></KanbanCardSettings>
        </SfKanban>
    </Authorized>
</AuthorizeView>

@*    <SfKanban ID="Kanban" TValue="StoryBoard" KeyField="Status">
        <SfDataManager Url="/api/Default" UpdateUrl="/api/Default/Update" RemoveUrl="/api/Default/Delete" InsertUrl="/api/Default/Add" CrudUrl="/api/Default/Batch" Adaptor="Adaptors.UrlAdaptor"></SfDataManager>
        <KanbanColumns>
                <KanbanColumn HeaderText="To Do" KeyField="@(new List<string>() {"Open"})"></KanbanColumn>
                <KanbanColumn HeaderText="In Progress" KeyField="@(new List<string>() {"InProgress"})"></KanbanColumn>
                <KanbanColumn HeaderText="Testing" KeyField="@(new List<string>() {"Testing"})"></KanbanColumn>
                <KanbanColumn HeaderText="Done" KeyField="@(new List<string>() {"Close"})"></KanbanColumn>
            </KanbanColumns>
        <KanbanCardSettings HeaderField="StoryboardID" ContentField="StoryBoardID"></KanbanCardSettings>
    </SfKanban>*@


@code {

    SfKanban<StoryBoard> KanbanRef { get; set; }
    public StoryBoard storyBoard = new StoryBoard();
    public List<StoryBoard> StoryboardList = new List<StoryBoard>();

    private List<StoryBoard> KanbanDatasource = new List<StoryBoard>();
    //protected override async Task OnInitializedAsync()
    //{
    //    StoryboardList = await Task.Run(() => storyboardService.GetStoryboardDetails());
    //    KanbanDatasource = storyboardService.GetStoryboardDetails().ToList();
    //}

    public class Status
    {
        public string ID { get; set; }
        public string Text { get; set; }
    }
    public List<Status> localData = new List<Status>
    {new Status() { ID= "1", Text= "Open" },
        new Status() { ID= "2", Text= "Work in Progress" },
        new Status() { ID= "3", Text= "Finished" }
    };


    public class TasksModel
    {
        public string Id { get; set; }
        public string Title { get; set; }
        public string Status { get; set; }
        public string Summary { get; set; }
    }

    public List<TasksModel> Tasks = new List<TasksModel>()
    {
        new TasksModel { Id = "Task 1", Title = "BLAZ-29001", Status = "Open", Summary = "Analyze the new requirements gathered from the customer." },
        new TasksModel { Id = "Task 2", Title = "BLAZ-29002", Status = "Open", Summary = "Show the retrieved data from the server in grid control." },
        new TasksModel { Id = "Task 3", Title = "BLAZ-29003", Status = "InProgress", Summary = "Improve application performance" },
        new TasksModel { Id = "Task 4", Title = "BLAZ-29004", Status = "Testing", Summary = "Fix the issues reported by the customer." },
        new TasksModel { Id = "Task 5", Title = "BLAZ-29005", Status = "Testing", Summary = "Fix the issues reported in Safari browser." },
        new TasksModel { Id = "Task 6", Title = "BLAZ-29006", Status = "Close", Summary = "Analyze SQL server 2008 connection." },
        new TasksModel { Id = "Task 7", Title = "BLAZ-29007", Status = "Close", Summary = "Analyze grid control." },
        new TasksModel { Id = "Task 8", Title = "BLAZ-29008", Status = "Close", Summary = "Stored procedure for initial data binding of the grid." }
    };
}

